<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>The Marketing Alchemist: The Balance Protocol</title>

  <!-- DM speech font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="./assets/styles.css" />
</head>

<body>
  <main class="screen" id="screen">

    <!-- BANK IDENTIFIER (left rail) -->
    <button class="bankRail" id="bankRail" aria-label="BANK Identifier">
      <!-- Collapsed: just letters -->
      <div class="bankLetters" aria-hidden="false">
        <span data-bank="B">B</span>
        <span data-bank="A">A</span>
        <span data-bank="N">N</span>
        <span data-bank="K">K</span>
      </div>

      <!-- Expanded: meanings on LEFT, letters on RIGHT -->
      <div class="bankExpanded" id="bankExpanded" aria-hidden="true">
        <div class="bankRow"><span><b>Blueprint</b> (structure, steps)</span></div>
        <div class="bankRow"><span><b>Action</b> (speed, results)</span></div>
        <div class="bankRow"><span><b>Nurturing</b> (support, trust)</span></div>
        <div class="bankRow"><span><b>Knowledge</b> (data, logic)</span></div>
      </div>
    </button>

    <!-- floating settings button (top-right) -->
    <button class="settingsFab" id="devBtn" aria-label="Settings">⚙️</button>

    <!-- BOTTLES GRID -->
<section class="playfield" aria-label="Bottles Grid">
  <!-- ✅ NEW: centered frame that caps width on wide devices -->
  <div class="playfieldFrame">

    <!-- Thesis Bar (top overlay) -->
    <div class="thesisBar" id="thesisBar">
      <div class="thesisLeft">
        <div class="thesisLabel" id="thesisLabel">Thesis: —</div>
        <div class="thesisSub" id="thesisSub">—</div>
      </div>
      <button class="thesisBtn" id="glossaryBtn" aria-label="Open Glossary">Glossary</button>
    </div>

    <div class="grid" id="grid"></div>

  </div>
</section>

    <!-- MODIFIERS (bottom bar) -->
    <nav class="modBar" aria-label="Modifiers">
      <button class="modSlot" id="modSlot1" aria-label="Modifier slot 1"><span>+</span></button>
      <button class="modSlot" id="modSlot2" aria-label="Modifier slot 2"><span>+</span></button>
      <button class="modSlot" id="modSlot3" aria-label="Modifier slot 3"><span>+</span></button>
    </nav>

    <!-- DM + SPEECH WRAPPER (moves as one unit) -->
<dialog class="dmWrap" id="dmWrap" aria-hidden="true">
  <div class="dmInner">

    <!-- DM card centered -->
    <aside class="dmCharacter" id="dmCharacter">
      <button class="dmClose" id="dmClose" aria-label="Close DM">✕</button>
      <div class="dmAvatar" id="dmAvatar" title="Marketing Alchemist"></div>
    </aside>

    <!-- Speech bubble bottom-center, layered on top of DM -->
    <section class="speech" id="speech" aria-hidden="true">
      <div class="speechInner">
        <div class="speechTitle" id="questTitle">—</div>
        <div class="speechText" id="speechText"></div>
        <div class="speechSmall" id="speechSmall"></div>
      </div>
    </section>

  </div>
</dialog>

    <!-- overlays -->
    <div class="toast" id="toast"></div>
    <div class="pourFX" id="pourFX"></div>

    <!-- GLOSSARY (pauses game) -->
    <dialog class="glossary" id="glossary">
      <form method="dialog">
        <header>
          <div><b>Glossary</b></div>
          <button class="x" value="cancel" aria-label="Close">✕</button>
        </header>

        <div class="glossaryBody">
          <div class="glossaryNote" id="glossaryNote">
            All elements and their roles, teachings, and punishments.
          </div>
          <div class="glossaryList" id="glossaryList"></div>
        </div>

        <menu>
          <button value="cancel">Close</button>
        </menu>
      </form>
    </dialog>
    
        <!-- MOD CARD OVERLAY -->
    <dialog class="modOverlay" id="modOverlay">
  <div class="modCard">
    <button class="modX" id="modOverlayClose" type="button" aria-label="Close">✕</button>

    <div class="modTop">
      <img id="modOverlayImg" alt="" />
      <div class="modMeta">
        <div class="modName" id="modOverlayName">—</div>
        <div class="modDesc" id="modOverlayDesc">—</div>
      </div>
    </div>

    <div class="modActions">
      <button id="modOverlayCancel" type="button" class="modBtn ghost">Cancel</button>
      <button id="modOverlayUse" type="button" class="modBtn primary">Use</button>
    </div>
  </div>
</dialog>

    <!-- SETTINGS -->
    <dialog class="settings" id="settings">
      <form method="dialog">
        <header>
          <div><b>Settings</b></div>
          <button class="x" value="cancel" aria-label="Close">✕</button>
        </header>

        <!-- INFO PANEL -->
        <section class="infoPanel">
          <div class="infoRow"><span>Game</span><b>The Balance Protocol</b></div>
          <div class="infoRow"><span>Player</span><b id="infoPlayer">—</b></div>
          <div class="infoRow"><span>Level</span><b id="infoLevel">—</b></div>
          <div class="infoRow"><span>Moves</span><b id="infoMoves">—</b></div>
          <div class="infoRow"><span>Invalid</span><b id="infoInvalid">—</b></div>
          <div class="infoRow"><span>Thesis</span><b id="infoThesis">—</b></div>
        </section>

        <label class="row">
          <span>API Base</span>
          <input id="apiBase" class="mono" placeholder="https://..." />
        </label>

        <menu>
  <button id="retryLevelBtn" type="button">Retry Level</button>
  <button id="factoryResetBtn" type="button" class="danger">Factory Reset</button>
  <button value="cancel" class="x">Done</button>
</menu>
      </form>
    </dialog>

    <div class="sr" id="statusOut" aria-live="polite">ready</div>
  </main>

<script type="module" src="./src/game/app.js"></script>
</body>
</html>
